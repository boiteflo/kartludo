(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[525],{48110:function(e,t,a){"use strict";a.d(t,{Z:function(){return y}});var i=a(56843),r=a(55550),n=a(64562),s=a(99709),o=a(13687),c=function(){var e=this,t=e._self._c;return t("div",[e.hide?t("div",{staticClass:"absolute"},[t(r.Z,{staticStyle:{"z-index":"10"},attrs:{variant:"text"},on:{click:function(t){e.showDrawer=!0}}})],1):t(i.Z,{attrs:{app:"",dark:"",color:"black"}},[t("div",{staticStyle:{width:"320px",position:"absolute",bottom:"0px",top:"0px",left:"160px",overflow:"hidden"}},[t("img",{staticStyle:{width:"100px"},attrs:{src:a(70898)}})]),t("div",{staticStyle:{width:"100px",position:"absolute",bottom:"0px",top:"0px",left:"120px",overflow:"hidden"}},[t("img",{staticStyle:{width:"100px",height:"100%"},attrs:{src:a(38525)}})]),t(r.Z,{attrs:{variant:"text"},on:{click:function(t){e.showDrawer=!0}}}),t("router-link",{attrs:{to:"/gundam"}},[t(n.Z,{staticStyle:{position:"relative"},attrs:{target:"_blank",text:""},on:{click:function(t){return e.unselect()}}},[t("h3",{staticStyle:{position:"absolute",left:"0px",top:"-15px","letter-spacing":"5px"}},[e._v("GUNDAM")]),t("span",{staticStyle:{position:"absolute",top:"5px",left:"0px","font-size":"10px"}},[e._v(e._s(e.version))])])],1),t(o.Z),e._l(e.links,(function(a){return t("link-button",{key:"menuBarr"+a.Text,attrs:{url:a.Url,external:a.external,text:e.$vuetify.breakpoint.width>=1050?a.Text:"",icon:a.Icon},on:{click:function(t){return e.unselect()}}})}))],2),t(s.Z,{attrs:{absolute:"",temporary:"",color:"black"},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[t("img",{staticStyle:{width:"300px",height:"400px","object-position":"-50px 00px","object-fit":"cover",position:"absolute"},attrs:{src:a(68499)}}),t("br"),t("div",[t("router-link",{attrs:{to:"/daggerheart"}},[t(n.Z,{attrs:{target:"_blank",text:""}},[t("h3",{staticClass:"colorWhite"},[e._v("Gundam")])])],1),e._l(e.links,(function(a){return t("link-button",{key:"navigationDrawer"+a.Text,staticClass:"m5px w100p",attrs:{url:a.Url,external:a.external,text:a.Text,icon:a.Icon},on:{click:function(t){return e.unselect()}}})}))],2)]),!e.hide&&e.$vuetify.breakpoint.width>=800?t("div",{staticClass:"bg",staticStyle:{height:"60px"}}):e._e(),!e.hide&&e.$vuetify.breakpoint.width<800?t("div",{staticClass:"bg",staticStyle:{height:"20px"}}):e._e()],1)},d=[],l=a(69092),h=a(28310),p={name:"menuBarGundam",components:{linkButton:h.Z},props:["filteractive","hide"],data:()=>({store:l.h,version:"",searchString:"",showDrawer:!1,links:[{Text:"EncyclopÃ©die",Icon:"mdi-book",external:!0,Url:"https://docs.google.com/presentation/d/13EMZDLqcDxfhsLHIzuKSSBsFIvNwjc2QLpWlew3B8Bk/edit?usp=drive_link"},{Text:"Cartes",Icon:"mdi-cards",Url:"/gundamTcgFight"}]}),mounted(){this.version=this.$version},methods:{}},g=p,u=a(1001),f=a(90490),m=a.n(f),x=(0,u.Z)(g,c,d,!1,null,null,null);"function"===typeof m()&&m()(x);var y=x.exports},15525:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return W}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bg2 h100p"},[t("menu-bar-gundam",{attrs:{hide:!0}}),t("game")],1)},r=[],n=a(48110),s=a(64562),o=a(4324),c=function(){var e=this,t=e._self._c;return t("div",{key:e.refreshG,staticClass:"relative w100p h100p mask"},[t("div",{staticClass:"hide"},[e._l(16,(function(a){return t("div",{key:"x"+a,staticClass:"bgYellow absolute w100p",style:{height:e.game?.grid.box.height+"px",top:e.getGridY(a-1)+"px"}})})),e._l(16,(function(a){return t("div",{key:"y"+a,staticClass:"bgRed absolute h100p",style:{width:e.game?.grid.box.width+"px",left:e.getGridX(a-1)+"px"}})}))],2),e._l(e.game?.fields.filter((e=>e.show)),(function(a){return t("div",{key:a.zone,class:{absolute:!0,bg3:a.zone.endsWith("2"),bg:a.zone.endsWith("1"),fontSize1em:!0,textVerticalCenter:!0,"text-center":!0,bgRed2:a.isPlayer1==e.game.isPlayer1&&"locationHand"===a.location},style:e.getFieldStyle(a.x,a.y,a.width,a.height),attrs:{id:a.zone},on:{dragover:e.onDragOver,drop:function(t){return e.onDrop(t,a)}}},[e._v(" "+e._s(a.text)+" ")])})),e.game?t("div",{staticClass:"bgRed absolute hide",style:e.getFieldStyle(e.game.grid.centerMini.card1.x,e.game.grid.centerMini.card1.y,e.game.grid.centerMini.card1.width,e.game.grid.centerMini.card1.height)}):e._e(),e.game?t("div",{staticClass:"bgRed absolute hide",style:e.getFieldStyle(e.game.grid.centerMini.card2.x,e.game.grid.centerMini.card2.y,e.game.grid.centerMini.card2.width,e.game.grid.centerMini.card2.height)}):e._e(),e.game?t("div",{staticClass:"bgYellow absolute hide",style:e.getFieldStyle(e.game.grid.centerMini.text.x,e.game.grid.centerMini.text.y,e.game.grid.centerMini.text.width,e.game.grid.centerMini.text.height)}):e._e(),e.game&&e.game.textEffect?t("div",{staticClass:"bgWhite absolute mask text-center textVerticalCenter fontSize150em",style:{...e.getFieldStyle(e.game.textEffect?.position.x,e.game.textEffect?.position.y,e.game.textEffect?.position.width,e.game.textEffect?.position.height),"z-index":11},attrs:{id:"textEffect"}},[t("div",{domProps:{innerHTML:e._s(e.game.textEffect.text)}})]):e._e(),e.aside?t("div",{staticClass:"flex absolute"},[t("div",{staticClass:"bg",staticStyle:{width:"300px",height:"100%"}},[t("div",{staticClass:"relative"},[t("gameCard",{attrs:{card:e.cardCenter,folder:"Gundam/cards/"}})],1),t("div",{staticStyle:{height:"420px"}}),t(s.Z,{staticClass:"bg m5px",attrs:{target:"_blank",text:""},on:{click:e.start}},[t(o.Z,[e._v("mdi-arrow-right-thin")]),e._v(" Start ")],1),t(s.Z,{staticClass:"bg m5px",attrs:{target:"_blank",text:""},on:{click:e.nextTurn}},[t(o.Z,[e._v("mdi-arrow-right-thin")]),e._v(" End Turn ")],1),t("div",{staticClass:"mp5px",domProps:{innerHTML:e._s(e.game?.logs)}})],1)]):e._e(),e._l(e.cards,(function(a){return t("div",{key:"B"+a.index,on:{dragover:e.onDragOver,drop:function(t){return e.onDrop(t,a)}}},[t("gameCard",{attrs:{id:"C"+a.index,card:a,folder:"Gundam/cards/",shine:a.selectable&&!e.freeze,hidestat:a.hidestat,draggable:"true"},on:{mouseover:function(t){return e.showCardMouseOver(a)},click:function(t){return e.showCard(a)},dragover:e.onDragOver,drop:function(t){return e.onDrop(t,a)}}})],1)})),e.game?t("div",[t("div",{staticClass:"bgYellow absolute cirlce10px",style:{left:e.game.grid.x0+"px",top:"30px",height:e.game.grid.hand.height-25+"px",width:e.game.fields[0].width+"px"}},[t(s.Z,{class:{bg:!0,w100p:!0,h100p:!0,shine:!e.freeze,fontSize1em:!0},staticStyle:{"min-width":"0px"},attrs:{target:"_blank",text:""},on:{click:e.nextTurn}},[e._v(" End "),t("br"),e._v("Turn ")])],1)]):e._e(),e.game?.popup?t("div",{staticClass:"textVerticalCenter",staticStyle:{"z-index":"12",width:"100%",height:"64px",position:"fixed",top:"0px",left:"0px"}},[t("div",{staticStyle:{"background-color":"#FFFF00F0",width:"100%",height:"100%"}},[t("h3",{staticClass:"text-center colorBlack textVerticalCenter w100p",domProps:{innerHTML:e._s(e.game?.popup.text)}}),t("div",{staticClass:"flex-wrap w100p"},e._l(e.game?.popup.cards,(function(i,r){return t("div",{key:"PopUpCard"+r,staticClass:"mp5px"},[t("img",{style:e.getFieldStyleObj(e.game?.grid.card6),attrs:{src:a(85182)("./"+i.id+".webp")},on:{click:function(t){return e.selectChoiceCard(i)}}})])})),0),t("span",{staticClass:"relative"},e._l(e.game?.popup.choices,(function(a,i){return t("span",{key:"Choice"+i},[a.text?t(s.Z,{staticClass:"m10px",on:{click:function(t){return e.selectChoice(a)}}},[e._v(" "+e._s(a.text)+" ")]):e._e()],1)})),0)])]):e._e(),e.game&&e.game.tasks?t("div",{staticClass:"absolute hide",staticStyle:{"z-index":"12"}},[e._v(" "+e._s(e.game.tasks.map((e=>e.id)))+" ")]):e._e(),t("div",{staticClass:"absolute bgWhite mask",staticStyle:{top:"80px",width:"100%",height:"0px","z-index":"13"},attrs:{id:"divTitleParent"}},[t("div",{staticClass:"relative"},[t("div",{staticClass:"text-center absolute w100p title",staticStyle:{left:"-000px",top:"30px"}},[e._v(e._s(e.title)+" ")])])]),t("gameCard",{staticStyle:{"z-index":"12"},attrs:{id:"cardCenter",card:e.cardCenter,folder:"Gundam/cards/"},on:{click:function(t){return e.showCard(null)}}}),t("div",{staticClass:"absolute hide"},[e._v(" hello world ")])],2)},d=[],l=(a(57658),a(61711)),h=a.n(l),p=a(47327);class g{static removeOneTurnEffect(e){e.filter((e=>e.removeEndTurn)).forEach((e=>{const t=[];e.removeEndTurn.forEach((a=>{delete e[a.effect],t.push(a.effect)})),m.log(`${e.name} lost ${t.join(", ")}`)}))}static handleEffects(e,t,a,i){const r=this.getEffectsRemaining(i,t,a);if(!r||r.length<1)return{};const n=r.map((e=>this.getEffectText(e))).join("<br>"),s=m.delay,o=m.cardHighlight.find((e=>e.index===t.index));return o?(y.addTasks(m.game.tasks,[{id:y.taskRefreshField.name,isPlayer1:t.isPlayer1},{id:y.taskTextHide.name,delay:s},{id:y.taskTextDelete.name}]),this.apply(i,e,t,a)):(m.game.tasks=[{id:y.taskCardsToMiniCenter.name,delay:s,card1:t,card2:a,text:n}].concat(m.game.tasks),{stop:!0})}static getEffectText(e){const t=[e.id?.toString(),e.value?.toString(),e.target?.toString(),e.effect2?.toString()];return e.ap&&t.push("ap "+e.ap),e.hp&&t.push("hp "+e.ap),t.filter((e=>e&&e.length>0)).join(" ")}static apply(e,t,a,i){const r=[this.onpair,this.onlink];let n=a.effects?a.effects:[];r.includes(e)&&(n=n.concat(i.effects)),a.effectsRemaining=n.filter((t=>t.trigger==e));let s={};if(m.effects=[],a.effectsRemaining.length<1)return{nothing:!0};const o=[];return a.effectsRemaining.forEach(((e,r)=>{s.stop||(e.index=r,s={...s,...this.applyEffect(t,a,i,e)},e.oneTurn&&(a.removeEndTurn=a.removeEndTurn?a.removeEndTurn.concat([e]):[e]),s.stop||o.push(e.index))})),a.effectsRemaining=a.effectsRemaining.filter((e=>!o.includes(e.index))),s}static getEffectsRemaining(e,t,a){const i=[this.onpair,this.onlink];let r=t.effects?t.effects:[];i.includes(e)&&(r=r.concat(a.effects));let n=r.filter((t=>t.trigger==e));return e===this.onlink&&(n=n.concat(this.getEffectsRemaining(this.onpair,t,a))),n}static applyEffect(e,t,a,i){if(i.target&&!a)return"unit"===i.target?(alert("cant do that"),m.logEffect(i,"Can t handle this effect (because of target=unit) : "+JSON.stringify(i)),{stop:!0}):this[i.id](e,t,a,i)}static get1ShieldToHand(e,t,a,i){if(e.shield.length<1)return;const r=e.shield.splice(0,1)[0],n="Get one shield to hand";r.location=e.positions.shield.location,y.addTasks(m.game.tasks,[{id:y.taskMove.name,card1:r,to:m.locationHand,isPlayer1:e.isPlayer1}]),m.logEffect(i,n)}static top2DeckCard1Top1Bottom(e,t,a,i){if(!m.game.cardChoice){const t=[m.getAndRemoveFirst(e.deck),m.getAndRemoveFirst(e.deck)];return m.game.tasks=[{id:y.taskPopup.name,text:"Select the card that will go to the top deck, the other one will go bottom deck",cards:t,select:"top2DeckCard1Top1BottomSelect"}].concat(m.game.tasks),{stop:!0}}{const t=m.game.popup.cards.filter((e=>e.index!==m.game.cardChoice.index));e.deck=[m.game.cardChoice].concat(e.deck).concat(t),m.deletePopup()}}static protectionShieldLvXOrLower(e,t,a,i){if(e.base||a.index)return;const r=e.shield[0],n=r.level<i.value;return n&&m.logEffect(i,`attack cancel because ${t.name} has level < ${i.value}`),{stop:n}}static gainThisTurn(e,t,a,i){const r=m.clone(i);delete r.target,r.effect=r.effect2,m.logEffect(i,`${t.name} give ${i.effect2} to ${a.name}`),this.applyEffect(e,a,null,r),a.removeEndTurn=[r]}static incruise(e,t,a,i){t.ap+=i.ap,t.hp+=i.hp,m.logEffect(i,`${t.name} have been incruised by AP ${i.ap} and HP ${i.hp}`)}static sendToHand(e,t,a,i){return y.addTasks(m.game.tasks,[{id:y.taskCardToCenter.name,card1:t,isPlayer1:e.isPlayer1},{id:y.taskMove.name,card1:t,to:m.locationHand,isPlayer1:e.isPlayer1}]),m.logEffect(i,`${t.name} is send to hand`),{stop:!0}}static sendToField(e,t,a,i){return m.move(e,t,m.locationShield,m.locationField),m.logEffect(i,`${t.name} is send to hand`),{stop:!0,cancel:!0,refreshHandOpponent:!0}}static sendToBase(e,t,a,i){return t.location=e.positions.shield.location,y.addTasks(m.game.tasks,[{id:y.taskPlayCard.name,card1:t,zone:e.positions.field}]),{stop:!0}}static placeExResource(e,t,a,i){e.resourcesEx+=i.value,e.resourcesAvailable+=i.value,e.resAString=e.resourcesAvailable+"/"+e.resourcesMax,m.logEffect(i,`${t.name} deploy ${i.value} ex resource`)}static placeRestedResource(e,t,a,i){e.resourcesMax+=i.value,e.resAString=e.resourcesAvailable+"/"+e.resourcesMax,m.logEffect(i,`${t.name} deploy ${i.value} rested resource`)}static breach(e,t,a,i){(!t.breach||t.breach<i.value)&&(t.breach=i.value,m.logEffect(i,`${t.name} has breach ${i.value}`))}static deploy(e,t,a,i){const r=e.hand.filter((e=>e.name.includes(i.target)||e.attribute.includes(i.target)));if(r.length<1)return;const n=r[0];n.selectable=!1,n.canAttack=!1,m.move(e,n,n.location,m.locationField),m.logEffect(i,`${t.name} deploy ${n.name}`),this.apply(g.onplay,e,n,null)}static attackActiveEnnemy(e,t,a,i){(!t.attackActiveEnnemy||t.attackActiveEnnemy<i.value)&&(t.attackActiveEnnemy=i.value,m.logEffect(i,`${t.name} can attack unit with AP < ${i.value}`))}static immuneAp(e,t,a,i){t.breach&&(!t.immuneAp||t.immuneAp<i.value)&&(t.immuneAp=i.value,m.logEffect(i,`${t.name} is now immune to AP < ${i.value}`))}}(0,p.Z)(g,"onplay","onplay"),(0,p.Z)(g,"onpair","onpair"),(0,p.Z)(g,"onlink","onlink"),(0,p.Z)(g,"battle","battle"),(0,p.Z)(g,"burst","burst"),(0,p.Z)(g,"command","command"),(0,p.Z)(g,"self","self"),(0,p.Z)(g,"unit","unit"),(0,p.Z)(g,"pairUnit","pairUnit"),(0,p.Z)(g,"gainThisTurn","gainThisTurn"),(0,p.Z)(g,"gain","gain"),(0,p.Z)(g,"hand","hand");var u=g;class f{static getLocationArrayProperty(e){return e==this.locationEmpty?"empty":e==this.locationDeck?"deck":e==this.locationShield?"shield":e==this.locationHand?"hand":e==this.locationField?"field":e==this.locationBase?"base":e==this.locationResource?"resource":e==this.locationPair?"pair":"trash"}static spawnOrMove(e,t,a,i,r){const n=this.move(e,t,a,i,r);return this.spawnIfNot(n),n}static spawnIfNot(e){if(!e)return;f.game.cards.find((t=>t.index===e.index))||(f.game.cards=f.addIn(f.game.cards,e));const t=e.isPlayer1?f.game.player1:f.game.player2;e.position||(e.position=this.clone(t.positions.deck)),e.zindex=11}static move(e,t,a,i,r){!a&&t&&t.location&&(a=t.location);const n=f.getLocationArrayProperty(a),s=f.getLocationArrayProperty(i);t?e[n]=f.removeByIndex(e[n],t):t=e[n].splice(0,1)[0],t.isTemporaryCard||(e[s]=f.addIn(e[s],t)),n&&(t.position=t.position?t.position:this.clone(e.positions[n])),n&&(t.location=e.positions[n].location),t.isPlayer1=e.isPlayer1,t.active=!0,t.hidestat=t.location===f.locationTrash,t.pair&&(t.pair.isPaired=!1,t.pair.link=!1,this.move(e,t.pair,a,i,r),delete t.pair,t.link=!1);const o=[f.locationHand,f.locationField].includes(i);return o||(t.to=this.clone(e.positions[s]),i===this.locationTrash&&(t.to.height=0,t.hidestat=!0)),r||y.addTasks(f.game.tasks,[{id:y.taskRefreshField.name,isPlayer1:e.isPlayer1}]),t}static pair(e,t,a){const i=this.isCardUnit(t)?t:a,r=this.isCardPilot(t)?t:a,n=this.isLink(i,r),s=n?u.onlink:u.onpair,o=u.handleEffects(e,i,r,s);if(o.stop)return o;const c=f.getLocationArrayProperty(r.location);e[c]=f.removeByIndex(e[c],r),i.pair=r,r.selectable=!1,r.isPaired=!0,r.location=f.locationPair,r.zindex=1,i.zindex=2,i.ap+=r.ap,i.hp+=r.hp,this.isLink(i,r)&&(i.link=!0,r.link=!0,i.active=!0,i.selectable=!0,i.canAttack=!0)}static isLink(e,t){return e.link.includes(t.name)}static createCard(e){const t=this.clone(this.cards.find((t=>t.id===e)));return t.index=this.getNextIndex(),t}static getNextIndex(){return this.index++,this.index}static setActive(e,t){e.active=t,e.selectable=!1,e.canAttack=t;const a=e.active?0:90;e.to||(e.to=this.clone(e.position)),e.to.rotation=a}static getPlayerTurn(){return f.isPlayer1?f.game.player1:f.game.player2}static getPlayerTurnOpponent(){return f.isPlayer1?f.game.player2:f.game.player1}static getPlayer(e){return e?f.game.player1:f.game.player2}static getOpponent(e){return e?f.game.player1:f.game.player2}static addListInArrayAfterIndex(e,t,a){return e?a?t>=e.length?e.concat(a):t<0||t>=e.length?a.concat(e):[...e.slice(0,t),...a,...e.slice(t)]:e:a}static getAndRemoveFirst(e){return e.splice(0,1)[0]}static removeByIndex(e,t){return e.filter((e=>e.index!==t.index))}static addIn(e,t){if(e&&!e.includes((e=>e.index===t.index)))return e.concat([t])}static sortRandom(e){return e.sort((()=>Math.random()-.5))}static deletePopup(){delete this.game.popup,delete this.game.choice,delete this.game.actionPlayer,delete this.game.actionOpponent,delete this.game.cardChoice}static isCardUnit(e){return e.type?.includes(0)}static isCardPilot(e){return e.type?.includes(1)}static isCardCommand(e){return e.type?.includes(2)}static isCardCommandPilot(e){return this.isCardPilot(e)&&this.isCardCommand(e)}static isCardBase(e){return e.type?.includes(3)}static log(e){this.game.logs=e+"<br>"+this.game.logs}static logEffect(e,t){this.log(t),this.effects=this.effects?this.effects.concat([t]):[t]}static clone(e){return Object.assign({},e)}}(0,p.Z)(f,"game",null),(0,p.Z)(f,"grid",void 0),(0,p.Z)(f,"index",1),(0,p.Z)(f,"isPlayer1",void 0),(0,p.Z)(f,"delay",void 0),(0,p.Z)(f,"effects",void 0),(0,p.Z)(f,"cardHighlight",[]),(0,p.Z)(f,"needTaskEndRefresh",!1),(0,p.Z)(f,"phase",0),(0,p.Z)(f,"phaseStart",0),(0,p.Z)(f,"phaseDraw",1),(0,p.Z)(f,"phaseResource",2),(0,p.Z)(f,"phaseMain",3),(0,p.Z)(f,"phaseAttack",4),(0,p.Z)(f,"phaseBlock",5),(0,p.Z)(f,"phaseAction",6),(0,p.Z)(f,"phaseDamage",7),(0,p.Z)(f,"phaseEnd",8),(0,p.Z)(f,"locationEmpty","locationEmpty"),(0,p.Z)(f,"locationTrash","locationTrash"),(0,p.Z)(f,"locationDeck","locationDeck"),(0,p.Z)(f,"locationShield","locationShield"),(0,p.Z)(f,"locationHand","locationHand"),(0,p.Z)(f,"locationField","locationField"),(0,p.Z)(f,"locationBase","locationBase"),(0,p.Z)(f,"locationResource","locationResource"),(0,p.Z)(f,"locationPair","locationPair");var m=f;class x{static addTasks(e,t){m.needTaskEndRefresh=!0,t.forEach((t=>e.push(t)))}static alreadyInclude(e,t){return e.find((e=>this.isEqual(e,t)))}static isEqual(e,t){const a=e.id===t.id&&e.isPlayer1===t.isPlayer1&&e.value===t.value;return!1!==a&&(!(e.card&&!t.card)&&(!(!e.card&&t.card)&&((!e.card||!t.card||e.card.index!==t.card.index)&&a)))}static removeDelay(e,t){const a=[...e].reverse().find((e=>e.id===t&&e.delay));a&&delete a.delay}static handleTasks(e){let t=e.tasks[0];e.refresh=!!t;let a=0;while(t&&a<100){const i=t.isPlayer1?t.isPlayer1:t.card1&&t.card1.isPlayer1?t.card1.isPlayer1:t.isPlayer1,r=i?e.player1:e.player2,n=this[t.id](e,t,r);if(n&&n.stop)return e;if(t.delay)return e.wait=t.delay,t=e.tasks.splice(0,1)[0],e;t=e.tasks.splice(0,1)[0],t=e.tasks[0],a++}return m.needTaskEndRefresh&&this.taskEndRefresh(e),e}static taskEndRefresh(e){m.needTaskEndRefresh=!1,m.cardHighlight=[],e.manager.refreshFieldAndHand(e.player1),e.manager.refreshFieldAndHand(e.player2),e.refresh=!0}static taskRefreshField(e,t,a){e.manager.refreshFieldAndHand(a)}static taskTitleShow(e,t,a){e.showTitle=t.value}static taskTextShow(e,t,a){e.textEffect={text:t.text,position:m.clone(m.grid.centerMini.text)},e.textEffect.to=m.clone(e.textEffect.position),e.textEffect.position.height=0}static taskTextHide(e,t,a){e.textEffect&&(e.textEffect.position.height=m.grid.centerMini.text.height,e.textEffect.to={...m.clone(e.textEffect.position),height:0},e.refreshOnlyTextEffect=!0)}static taskTextDelete(e,t,a){e.refreshOnlyTextEffect=!1,delete e.textEffect}static taskMove(e,t,a){m.spawnOrMove(a,t.card1,t.from,t.to,t.ignoreRefresh)}static taskMoveAndShowCenter(e,t,a){const i=m.spawnOrMove(a,t.card1,t.from,t.to,t.ignoreRefresh),r={id:this.taskCardToCenter.name,card1:i,isPlayer1:t.isPlayer1,delay:m.delay};m.game.tasks=m.addListInArrayAfterIndex(m.game.tasks,1,[r])}static taskCardsToMiniCenter(e,t,a){if(!t.card1)return;m.spawnIfNot(t.card1),m.cardHighlight.push(t.card1);const i=t.card2?m.grid.centerMini.card1:m.grid.centerMini.card3;t.card1.to=m.clone(i),t.card1.to.rotation=0,t.card1.zindex=11,t.card2&&(m.spawnIfNot(t.card2),m.cardHighlight.push(t.card2),t.card2.to=m.clone(m.grid.centerMini.card2),t.card2.to.rotation=0,t.card2.zindex=11),t.text&&this.taskTextShow(e,t,a)}static taskCardToCenter(e,t,a){t.card1&&(m.spawnIfNot(t.card1),m.cardHighlight.push(t.card1),t.card1.to=m.clone(m.grid.center),t.card1.to.rotation=0,t.card1.zindex=11)}static taskAttack(e,t,a){return e.taskAttack=t,e.manager.attack(t.player,t.opponent,t.attacker,t.target,t.zone,t.breach)}static taskPopup(e,t,a){if(!e.cardChoice&&!e.choice)return e.popup=t,{stop:!0}}static taskPlayCard(e,t,a){const i=m.getPlayer(t.card1.isPlayer1);return e.manager.playCard(i,t.card1,t.card2,t.zone,t.regularPlay)}static taskPairCard(e,t,a){const i=m.getPlayer(t.card1.isPlayer1);return e.manager.pair(i,t.card1,t.card2)}}var y=x;class b{static createGrid(e,t){const a={};a.width=e,a.height=t-0,a.border=5,a.border2=2*a.border;const i=16;a.widthB=a.width-a.border*(i+1),a.heightB=a.height-a.border*(i+1),a.box={height:a.heightB/i},a.box.width=a.widthB/i,a.boxbig={height:2*a.box.height+a.border,width:2*a.box.width+a.border},a.hand={width:(a.box.width+a.border)*i-a.border,height:3*(a.box.height+a.border)-a.border},a.field={width:a.hand.width-a.box.width-a.border,height:a.hand.height+2*(a.box.height+a.border)},a.hand.card=this.getCardSize(a.hand.width,a.hand.height,6),a.field.card=this.getCardSize(a.field.width,a.field.height,6,a.field.cardHeightPercent),a.card6=this.getCardSize(a.width,a.height,6);for(let r=0;r<i;r++)a["x"+r]=5+r*(a.box.width+5),a["y"+r]=5+r*(a.box.height+5);return a.center=this.getCardSize(a.width-a.border2,a.height-a.border2,1),a.centerMini={width:e,height:t,location:0,zone:"centerMini1"},a.centerMini.card1=this.getCardSize(a.centerMini.width,a.centerMini.height,2),a.centerMini.x=(e-2*a.centerMini.card1.width)/2,a.centerMini.y=5,a.centerMini.card1.x=a.centerMini.x,a.centerMini.card1.y=a.centerMini.y,a.centerMini.card2=m.clone(a.centerMini.card1),a.centerMini.card2.x+=a.centerMini.card1.width,a.centerMini.card3={...a.centerMini.card1,x:a.centerMini.card1.x+a.centerMini.card1.width/2},a.centerMini.text={x:a.centerMini.x,y:a.centerMini.y+a.centerMini.card1.height,width:2*a.centerMini.card1.width},a.centerMini.text.height=t-a.centerMini.text.y-a.border,a.centerMini.text.height=Math.min(a.centerMini.text.height,150),a}static getPositions(e,t){let a={};return a=e.box.width>50?{base:this.createZone(t,e.x15,e.y8,e.x0,e.y7,e.box.width,e.box.height,"base",m.locationBase),shield:this.createZone(t,e.x15,e.y9,e.x0,e.y6,e.box.width,e.box.height,"shield",m.locationShield),deck:this.createZone(t,e.x15,e.y10,e.x0,e.y5,e.box.width,e.box.height,"deck",m.locationDeck),trash:this.createZone(t,e.x15,e.y11,e.x0,e.y4,e.box.width,e.box.height,"trash",m.locationTrash),resource:this.createZone(t,e.x15,e.y12,e.x0,e.y3,e.box.width,e.box.height,"res",m.locationResource),hand:this.createZone(t,e.x0,e.y13,e.x1,e.y0,e.hand.width,e.hand.height,"hand",m.locationHand),field:this.createZone(t,e.x0,e.y8,e.x1,e.y3,e.field.width,e.field.height,"field",m.locationField)}:{base:this.createZone(t,e.x14,e.y8,e.x0,e.y7,2*e.box.width,e.box.height,"base",m.locationBase),shield:this.createZone(t,e.x14,e.y9,e.x0,e.y6,2*e.box.width,e.box.height,"shield",m.locationShield),deck:this.createZone(t,e.x14,e.y10,e.x0,e.y5,2*e.box.width,e.box.height,"deck",m.locationDeck),trash:this.createZone(t,e.x14,e.y11,e.x0,e.y4,2*e.box.width,e.box.height,"trash",m.locationTrash),resource:this.createZone(t,e.x14,e.y12,e.x0,e.y3,2*e.box.width,e.box.height,"res",m.locationResource),hand:this.createZone(t,e.x0,e.y13,e.x2,e.y0,e.hand.width,e.hand.height,"hand",m.locationHand),field:this.createZone(t,e.x0,e.y8,e.x2,e.y3,e.field.width-5-e.box.width,e.field.height,"field",m.locationField)},a.field.cardHeightPercent=m.grid.field.cardHeightPercent,t||(a.hand.width=a.hand.width-e.box.width-3*e.border2),a}static createZone(e,t,a,i,r,n,s,o,c){const d=e?"1":"2";return{x:e?t:i,y:e?a:r,zone:o+d,width:n,height:s,location:c,isPlayer1:e,show:!0}}static createField(e,t){let a=[e.deck,e.trash,e.shield,e.resource,e.hand,e.field,e.base].concat([t.deck,t.trash,t.shield,t.resource,t.hand,t.field,t.base]).concat([m.game.grid.centerMini]);return a}static refresh(e,t,a,i){let r=t.height;t.location==m.locationField&&(r*=.75);const n=a?t:this.getCardSize(t.width,r,e.length,t.cardHeightPercent);e.forEach(((a,r)=>{const s=a.active?0:90;a.bgposition="0 0",a.to=this.getWrapPosition(t,n,e.length,r,s,i),a.location=t.location,m.cardHighlight.find((e=>e.index===a.index))||(a.zindex=a.pair?2:1),t.location==m.locationField&&a.pair&&(a.pair.to=this.getPairPosition(a.to))}))}static getPairPosition(e){const t=m.clone(e);return t.y+=.25*t.height,t.rotation=0,t}static getCardSize(e,t,a,i){let r=e/(a+.25),n=150*r/107;i&&(n*=i),n>t&&(n=t,r=107*n/150,i&&(r*=1-i+1));const s=(e-r)/2,o=(t-n)/2;return{x:s,y:o,width:r,height:n}}static getPositionHandWithRotation(e,t,a,i){const r=.75*m.grid.card.width,n=r/2,s=a<i/2?-1:1;let o=0,c=i/2,d=0;if(this.isPair(i)){const e=m.grid.hand.width/2-n+n*s;c=a<i/2?Math.floor(i/2)-1:Math.ceil(i/2),d=e+Math.abs(c-a)*r*s}else{const e=m.grid.hand.width/2-n;d=e+Math.abs(c-a)*r*s}const l=e.isPlayer1?1:-1;o=a-c;const h=l*Math.round(o/c*20),p=l*(r/4)*Math.abs(c-a);t.ap=a,t.hp=c;const g={x:e.positions.hand.x+d,y:e.positions.hand.y+p+20,width:m.grid.card.width,height:m.grid.card.height,rotation:h};return g}static isPair(e){return e%2==0}static getCenter(e,t,a,i){const r=e/2,n=a/2,s=n-i;return r-s*t}static getWrapPosition(e,t,a,i,r,n){if(a<n||e.height<2*t.height)return this.getCardPositionXY(e,t,a,i,r);const s=Math.floor(a/2),o=i<s?i:i-s,c=a-s,d=this.getCardSize(e.width,e.height/2,c,e.cardHeightPercent),l=i<s?e:{...e,y:e.y+d.height};return this.getCardPositionXY(l,d,c,o,r)}static getCardPositionXY(e,t,a,i,r){return{x:e.x+this.getXCenter(e.width,t.width,a,i),y:e.y,width:t.width,height:t.height,rotation:r}}static getXCenter(e,t,a,i){const r=e/a;return r/2+r*i-t/2}}var v=b;class w{static createGame(e,t,a){m.game={cards:[],tasks:[],popup:null},m.cards=e.getCards(),m.grid=v.createGrid(t,a),m.game.grid=m.grid;const i=e.getDeckLenth();m.game.player1=this.createPlayer(m.cards,i,!0),m.game.player2=this.createPlayer(m.cards,i,!1),m.game.player1.positions=v.getPositions(m.grid,!0),m.game.player2.positions=v.getPositions(m.grid,!1),m.game.fields=v.createField(m.game.player1.positions,m.game.player2.positions);const r=1==Math.floor(2*Math.random());m.isPlayer1=r;for(let n=0;n<e.getHandStartLength();n++)m.spawnOrMove(m.game.player1,null,m.locationDeck,m.locationHand,!0),m.spawnOrMove(m.game.player2,null,m.locationDeck,m.locationHand,!0);return m.game}static createPlayer(e,t,a){let i=[];return e.forEach((e=>{i.push(m.createCard(e.id)),i.push(m.createCard(e.id)),i.push(m.createCard(e.id)),i.push(m.createCard(e.id))})),i=i.splice(0,t),i.forEach((e=>{e.index=m.getNextIndex(),e.isPlayer1=a,e.location=m.locationDeck})),i=m.sortRandom(i),{deck:i,shield:[],hand:[],field:[],trash:[],isPlayer1:a,base:[],empty:[]}}}var k=w;class C{static createGame(e,t,a){return k.createGame(e,t,a),m.game.manager=e,m.delay=e.getAnimDuration(),e.setup(m.game),this.nextTurn(m.game)}static nextTurn(e){m.isPlayer1=!m.isPlayer1,e.isPlayer1=m.isPlayer1;const t=m.isPlayer1?"1":"2";return y.addTasks(e.tasks,[{id:y.taskTitleShow.name,value:"New turn for player "+t,isPlayer1:m.isPlayer1,delay:1200},{id:y.taskMoveAndShowCenter.name,isPlayer1:m.isPlayer1,from:m.locationDeck,to:m.locationHand,ignoreRefresh:!0}]),e.manager.nextTurn(),y.handleTasks(e)}static continue(e){return this.endAnimation(e),y.handleTasks(e)}static endAnimation(e){e.cards.forEach((e=>{e.positionDrag&&(e.position={...e.position,x:e.positionDrag.x,y:e.positionDrag.y}),e.to&&(e.position=e.to),delete e.to,delete e.positionOld,delete e.positionDrag})),delete e.wait,delete e.showTitle,e.refresh=!0}static playCard(e,t,a,i){return y.addTasks(e.tasks,[{id:y.taskPlayCard.name,card1:t,card2:a,zone:i,regularPlay:!0}]),e}static selectChoiceCard(e,t){return e.manager.selectChoiceCard(e,t),e}static selectChoice(e,t){return e.manager.selectChoice(e,t),e}}var T=C,P=JSON.parse('{"_":[{"id":"GD01-028","level":5,"cost":3,"name":"Gundam Sandrock","type":[0],"attribute":"(Operation Meteor)","link":"[Quatre Raberba Winner]","effectText":"Deploy Hand to Field (Maganac Corps)","effects":[{"trigger":"onplay","id":"deploy","target":"Maganac Corps"}],"pilot":"","burstText":"","targetUnit":false,"ap":4,"hp":4},{"id":"GD01-034","level":4,"cost":2,"name":"Gundam Heavyarms","type":[0],"attribute":"(Operation Meteor)","link":"[Trowa Barton]","effectText":"During Pair this unit gains Breach 3","effects":[{"trigger":"onpair","id":"breach","value":3}],"pilot":"","burstText":"","targetUnit":false,"ap":3,"hp":4},{"id":"GD01-040","level":5,"cost":2,"name":"Wing Gundam","type":[0],"attribute":"(Operation Meteor)","link":"[Heero Yuy]","effectText":"","effects":[],"pilot":"","burstText":"","targetUnit":false,"ap":4,"hp":3},{"id":"GD01-041","level":4,"cost":3,"name":"Shenlong Gundam","type":[0],"attribute":"(Operation Meteor)","link":"[Chang Wufei]","effectText":"Breach 3","effects":[{"trigger":"onplay","id":"breach","value":3}],"pilot":"","burstText":"","targetUnit":false,"ap":4,"hp":3},{"id":"GD01-091","level":4,"cost":1,"name":"Chang Wufei","type":[1],"attribute":"(Operation Meteor)","link":"","effectText":"xxx","effects":[{"trigger":"onpair","target":"pairUnit","id":"immuneAp","value":4,"oneTurn":true},{"trigger":"burst","id":"sendToHand"}],"pilot":"During your turn, if this Unit has Breach, it can\'t receive battle damage from enemy Units with 3 or less AP.","burstText":"Add this card to your hand","targetUnit":false,"ap":2,"hp":1},{"id":"GD01-107","level":3,"cost":3,"name":"First Contact","type":[2],"attribute":"","link":"","effectText":"Main : Place 1 rested Resource.","effects":[{"trigger":"command","id":"placeRestedResource","value":1},{"trigger":"burst","id":"placeExResource","value":1}],"pilot":"","burstText":"Place 1 Ex Resource.","targetUnit":false,"ap":0,"hp":0},{"id":"ST02-001","level":6,"cost":4,"name":"Wing Gundam","type":[0],"attribute":"(Operation Meteor)","link":"[Heero Yuy]","effectText":"Breach 5. This Unit may choose an active enemy Unit that is Lv4 or lower as its attack target.","effects":[{"trigger":"onplay","id":"breach","value":5},{"trigger":"onplay","id":"attackActiveEnnemy","value":5}],"pilot":"","burstText":"","targetUnit":false,"ap":4,"hp":5},{"id":"ST02-002","level":3,"cost":3,"name":"Wing Gundam (Bird Mode)","type":[0],"attribute":"(Operation Meteor)","link":"[Heero Yuy]","effectText":"Deploy : Place 1 Ex Resource","effects":[{"trigger":"onplay","id":"placeExResource","value":1}],"pilot":"","burstText":"","targetUnit":false,"ap":2,"hp":2},{"id":"ST02-005","level":2,"cost":2,"name":"Maganac","type":[0],"attribute":"(Maganac Corps)","effects":[],"link":"","effectText":"","pilot":"","burstText":"","targetUnit":false,"ap":3,"hp":2},{"id":"ST02-010","level":4,"cost":1,"name":"Heero Yuy","type":[1],"attribute":"(Operation Meteor)","link":"","effectText":"","effects":[{"trigger":"onlink","type":"gain","target":"pairUnit","id":"incruise","ap":1,"hp":1},{"trigger":"burst","id":"sendToHand"}],"pilot":"This Unit get AP+1 and HP+1 while linked.","burstText":"Add this card to your hand","targetUnit":false,"ap":2,"hp":1},{"id":"ST02-012","level":4,"cost":1,"name":"Trowa Barton","type":[1,2],"attribute":"(Operation Meteor)","link":"","effectText":"Main : Choose 1 of your Units. It gains Breach 3 during this turn.","effects":[{"trigger":"command","id":"gainThisTurn","target":"unit","effect2":"breach","value":3}],"pilot":"","burstText":"","targetUnit":true,"ap":1,"hp":1},{"id":"ST02-013","level":4,"cost":1,"name":"Quatre Raberba Winner","type":[1,2],"attribute":"(Operation Meteor)","link":"","effectText":"Action : during this battle, your shield area cards can\'t receive damage from ennemy Units that are Lv.4 or lower.","effects":[{"trigger":"action","id":"protectionShieldLvXOrLower","value":4}],"pilot":"","burstText":"","activateDuringBattle":true,"targetUnit":false,"ap":1,"hp":1},{"id":"ST02-015","level":2,"cost":2,"name":"Saint Gabriel Institute","type":[3],"attribute":"(Academy) (Stronghold)","link":"","effectText":"Deploy : Add 1 of your Shields to your hand. Then look at the top 2 cards of your deck and return 1 to the top and 1 to the bottom.","effects":[{"trigger":"burst","id":"sendToBase"},{"trigger":"onplay","id":"top2DeckCard1Top1Bottom"},{"trigger":"onplay","id":"get1ShieldToHand"}],"pilot":"","burstText":"Deploy this card","targetUnit":false,"ap":0,"hp":5},{"id":"EXBP-001","level":0,"cost":0,"name":"EX Base","type":[3],"attribute":"","link":"","effectText":"","pilot":"","burstText":"","burst":[],"targetUnit":false,"ap":0,"hp":3},{"id":"xxx","level":0,"cost":0,"name":"xxx","type":[0],"attribute":"xxx","link":"","effectText":"xxx","effects":[],"pilot":"xxx","burstText":"","burst":[],"targetUnit":false,"ap":0,"hp":0}]}');class E{static playFromHand(e,t,a,i,r){const n=i.isPlayer1==e.isPlayer1,s=r&&e.resourcesAvailable<t.cost;return!n||i.location==m.locationHand||s?{sendBack:!0}:this.playCard(e,t,a,i,r)}static playCard(e,t,a,i,r){let n=m.isCardPilot(t),s=m.isCardCommand(t);const o=this.askPilotOrCommand(t,a);if(n=o?o.isPilot:n,s=o?o.isCommand:s,o&&o.stop)return o;m.spawnIfNot(t);const c=u.handleEffects(e,t,a,u.onplay);if(c.stop)return c;if(m.isCardUnit(t)&&e.field.length<6)return t.canAttack=!1,r&&this.playCardCost(e,t),void m.move(e,t,t.location,e.positions.field.location);if(m.isCardBase(t))return e.base.length>0&&y.addTasks(m.game.tasks,[{id:y.taskMove.name,card1:e.base[0],to:m.locationTrash,isPlayer1:t.isPlayer1}]),m.move(e,t,t.location,m.locationBase),void(t.selectable=!1);if(n&&a&&m.isCardUnit(a))return t.pair||a.pair||t.isPaired||a.isPaired?void this.sendCardBackToSquareOne(t):(r&&this.playCardCost(e,t),void y.addTasks(m.game.tasks,[{id:y.taskPairCard.name,card1:t,card2:a}]));if(s){const i=u.handleEffects(e,t,a,u.command);return i.stop?i:(r&&this.playCardCost(e,t),void m.move(e,t,t.location,m.locationTrash,!0))}this.sendCardBackToSquareOne(t)}static playCardCost(e,t){let a=t.cost;e.resourcesEx>0&&(a=Math.max(0,a-e.resourcesEx),e.resourcesEx=Math.max(0,e.resourcesEx-t.cost)),e.resourcesAvailable-=a}static askPilotOrCommand(e,t){if(t&&m.isCardPilot(e)&&m.isCardCommand(e)){if(m.game.choice){const e="Pilot"===m.game.choice.text,t="Command"===m.game.choice.text;return m.deletePopup(),{isPilot:e,isCommand:t}}return m.game.tasks=[{id:y.taskPopup.name,text:"Do you want to play as pilot or command ?",choices:[{text:"Pilot"},{text:"Command"}]}].concat(m.game.tasks),{stop:!0}}}}var S=E;class D{static attack(e,t,a,i,r){const n=i.isPlayer1==e.isPlayer1;if(n)return{sendBack:!0};const s=m.getPlayerTurnOpponent(),o=s.field.filter((e=>e.block&&e.active));let c=!1;if(!m.game.blocker&&o.length>0){if(!m.game.cardChoice&&!m.game.choice)return m.game.tasks=[{id:y.taskPopup.name,text:"Select a blocker ?",cards:o,choices:[{text:"none"}]}].concat(m.game.tasks),{stop:!0};a=m.game.cardChoice,m.game.blocker=a,c=!0}if(delete m.game.blocker,m.deletePopup(),a&&a.isPlayer1===s.isPlayer1){const n=t.attackActiveEnnemy?a.level<t.attackActiveEnnemy:c||!a.active;return n?void this.startAttackAnimation(e,s,t,a,i,r):{sendBack:!0}}if(s.shield<1&&s.base.length<1)return{end:!0,isPlayer1:s.isPlayer1};if(s.base.length>0){const a=s.base[0];return void this.startAttackAnimation(e,s,t,a,i)}m.setActive(t,!1);let d=s.shield.splice(0,1)[0];const l=u.apply(u.burst,s,d,t);return l.stop?void 0:(y.addTasks(m.game.tasks,[{id:y.taskCardToCenter.name,card1:d,isPlayer1:d.isPlayer1,delay:m.delay},{id:y.taskMove.name,card1:d,to:m.locationTrash,isPlayer1:d.isPlayer1}]),{sendBack:!0})}static startAttackAnimation(e,t,a,i,r,n){const s=this.delay;y.addTasks(m.game.tasks,[{id:y.taskCardsToMiniCenter.name,delay:m.delay,card1:a,card2:i},{id:y.taskAttack.name,player:e,opponent:t,attacker:a,target:i,delay:s,zone:r,breach:n}])}static attackCard(e,t,a,i,r,n){const s=u.apply(u.battle,e,a);if(s.stop)return s;const o=m.delay;let c=n||a.ap;i.immuneAp&&c<i.immuneAp&&(c=0),i.hp-=c,c=i.ap,a.immuneAp&&a<i.immuneAp&&(c=0),a.hp-=c;const d=!n&&m.isCardUnit(i)&&a.breach&&i.hp<1;m.setActive(a,!1);const l=[];if(a.hp<1){a.dead=!0;const e=i.hp<1?null:m.delay;l.push({id:y.taskMove.name,delay:e,card1:a,to:m.locationTrash,isPlayer1:a.isPlayer1})}else d||l.push({id:y.taskRefreshField.name,isPlayer1:a.isPlayer1});i.hp<1?(i.dead=!0,l.push({id:y.taskMove.name,delay:o,card1:i,to:m.locationTrash,isPlayer1:i.isPlayer1})):l.push({id:y.taskRefreshField.name,isPlayer1:i.isPlayer1}),m.setActive(a,!1),y.addTasks(m.game.tasks,l),d&&this.attack(e,a,null,r,a.breach)}}var M=D;class A{static nextTurn(e){m.game.cards.forEach((e=>e.selectable=!1)),e.field.forEach((e=>{e.active=!0,e.canAttack=!0}))}static setSelectable(e){e.hand.forEach((t=>{const a=Math.max(e.resourcesMax,e.resourcesAvailable),i=t.level<=a&&t.cost<=e.resourcesAvailable,r=m.isPlayer1===t.isPlayer1;t.selectable=i&&r,m.isCardUnit(t)&&e.field.length>5&&(t.selectable=!1)})),e.field.forEach((e=>{e.selectable=e.canAttack}))}static play(e,t,a,i,r){const n=!a&&!i;let s={};return n?s.sendBack=!0:s=t.location===m.locationHand?S.playFromHand(e,t,a,i,r):t.location===m.locationField?this.attack(e,t,a,i):S.playCard(e,t,a,i,!1),s&&s.sendBack&&this.sendCardBackToSquareOne(t),s}static sendCardBackToSquareOne(e){const t=e.active?0:90;return e.to={...m.clone(e.position),rotation:t},e.position={...e.position,...e.positionDrag},m.game.refresh=!0,m.game}static attack(e,t,a,i,r){return M.attack(e,t,a,i,r)}static attackCard(e,t,a,i,r,n){return M.attackCard(e,t,a,i,r,n)}static selectChoiceCard(e,t){e.cardChoice=t}static selectChoice(e,t){e.choice=t}}var G=A;class Z{static getCards(){return P._}static getDeckLenth(){return 50}static getAnimDuration(){return 500}static getHandStartLength(){return 5}static setup(e){e.player1={...e.player1,base:[],shield:[],pair:[],resAString:"0",resourcesMax:0,resourcesAvailable:0,resourcesEx:0},e.player2={...e.player2,base:[],shield:[],pair:[],resAString:"0",resourcesMax:0,resourcesAvailable:0,resourcesEx:0},this.createDefaultBase(e.player1),this.createDefaultBase(e.player2);for(let a=0;a<6;a++)m.move(e.player1,null,m.locationDeck,m.locationShield),m.move(e.player2,null,m.locationDeck,m.locationShield);const t=m.isPlayer1?e.player1:e.player2;t.resourcesEx+=1}static createDefaultBase(e){const t=m.createCard("EXBP-001");return m.spawnOrMove(e,t,m.locationBase,m.locationBase),t.isTemporaryCard=!0,t}static nextTurn(){const e=m.getPlayerTurn();u.removeOneTurnEffect(m.game.cards),e.resourcesMax<10&&(e.resourcesMax+=1),e.resourcesAvailable=e.resourcesMax+e.resourcesEx,G.nextTurn(e);const t=e.base.length>0?e.base[0].hp+"hp ":"-";m.log(`-- Turn player ${e.number}, ${e.resourcesAvailable}re, ${e.shield.length}sh, ${t}ba`)}static refreshFieldAndHand(e){v.refresh(e.hand,e.positions.hand,!1,7),v.refresh(e.field,e.positions.field,!1,3),v.refresh(e.base,e.positions.base,!0);const t=e.trash.filter((e=>!e.to)).map((e=>e.index));m.game.cards=m.game.cards.filter((e=>!t.includes(e.index))),G.setSelectable(e),e.positions.deck.text=e.deck.length,e.positions.shield.text=e.shield.length,e.positions.trash.text=e.trash.length,e.positions.resource.text=e.resourcesAvailable+"/"+e.resourcesMax}static playCard(e,t,a,i,r){const n=G.play(e,t,a,i,r);return n&&n.end&&this.end(n.isPlayer1),n}static end(e){const t=e?"Defeat":"Victory";alert(t)}static attack(e,t,a,i,r,n){G.attackCard(e,t,a,i,r,n)}static selectChoiceCard(e,t){return G.selectChoiceCard(e,t)}static selectChoice(e,t){t.id&&t.id.startsWith("muligan")&&(m.deletePopup(),"muligan"==t.id&&this.doMuligan(e,e.player1)),G.selectChoice(e,t)}static doMuligan(e,t){t.deck=m.sortRandom(t.deck.concat(t.hand));const a=t.hand.map((e=>e.index));e.cards=e.cards.filter((e=>!a.includes(e.index))),t.hand=[];for(let i=0;i<this.getHandStartLength();i++)m.spawnOrMove(t,null,m.locationDeck,m.locationHand,!0);this.refreshFieldAndHand(t)}static pair(e,t,a){return m.pair(e,t,a)}}var _=Z,B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"absolute bgYellow cirlce15px",style:{left:e.card.position.x+"px",top:e.card.position.y+"px",width:e.card.position.width+"px",height:e.card.position.height+"px",transform:"rotate("+e.card.position.rotation+"deg)","z-index":e.card.zindex,cursor:e.shine?"pointer":""},on:{click:function(t){return e.$emit("click",e.card)}}},[e.card?t("img",{class:{w100p:!0,h100p:!0,shine:e.shine,absolute:!0},style:{"object-fit":"cover","object-position":e.card.bgposition,"pointer-events":"none"},attrs:{draggable:"false",src:a(97226)("./"+e.folder+e.card.id+".webp")},on:{mouseover:function(t){return e.$emit("mouseover",e.card)},contextmenu:function(t){return t.preventDefault(),e.$emit("clickright",e.card)}}}):t("div",[e._v("No card")]),e.hidestat||!e.card.ap&&!e.card.hp?e._e():t("div",{staticClass:"absolute cirlce10px textVerticalCenter centerDiv colorBlack fontSize1em",staticStyle:{width:"40px",height:"25px",top:"0px","background-color":"#FFFFFFB0"}},[e._v(" "+e._s(e.card.ap)+" - "+e._s(e.card.hp)+" ")]),e.card&&e.card.dead?t("div",{staticClass:"w100p h100p absolute shine cirlce15px",staticStyle:{"background-color":"#FF000050"}}):e._e()])},z=[],F={name:"game-card",props:["card","folder","shine","hidestat"]},O=F,H=a(1001),I=(0,H.Z)(O,B,z,!1,null,"9ee1a63e",null),R=I.exports,U={name:"game-vue",props:[],components:{gameCard:R},data:()=>({refreshG:0,aside:!1,freeze:!0,cards:[],cardCenter:{id:"GD01-028",position:{width:0}},game:null,title:""}),mounted(){document.body.style.overflow="hidden",window.addEventListener("resize",(()=>{this.refreshG++})),this.start()},methods:{start(){this.game=T.createGame(_,this.$vuetify.breakpoint.width,this.$vuetify.breakpoint.height),this.refreshGame()},nextTurn(){this.freeze||(this.game=T.nextTurn(this.game),this.refreshGame())},continue(){this.freeze=!1,this.game=T.continue(this.game),this.game.popup?this.freeze=!0:(this.game.refreshOnlyTextEffect&&this.animTextEffect(),this.game.refresh&&this.refreshGame())},playCard(e,t,a){this.freeze||(this.freeze=!0,this.game=T.playCard(this.game,e,t,a),this.refreshGame())},selectChoice(e){this.freeze=!0,this.game=T.selectChoice(this.game,e),this.refreshGame()},selectChoiceCard(e){this.freeze=!0,this.game=T.selectChoiceCard(this.game,e),this.refreshGame()},refreshGame(){this.freeze=!0,this.cards=this.game.cards,setTimeout((()=>{this.setDrag()}),10),this.game.showTitle&&this.showTitle(this.game.showTitle),this.refreshG++,setTimeout((()=>{this.beginAnimation()}),10)},animTextEffect(){let e=_.getAnimDuration();h().animateMultiple([{id:"textEffect",from:this.game.textEffect.position,to:this.game.textEffect.to,isIncrement:!1}],e)},beginAnimation(){let e=_.getAnimDuration();const t=!!(this.game&&this.game.textEffect&&this.game.textEffect.to),a=this.cards.filter((e=>e.to));if(e=!t&&a.length<1?10:_.getAnimDuration(),this.freeze=!0,setTimeout((()=>{this.endAnimation()}),e+10),a.length<1)return;const i=a.map((e=>({id:"C"+e.index,from:e.position,to:e.to,isIncrement:!1})));this.game&&this.game.textEffect&&this.game.textEffect.to&&i.push({id:"textEffect",from:this.game.textEffect.position,to:this.game.textEffect.to,isIncrement:!1}),h().animateMultiple(i,e)},endAnimation(){const e=this.game.wait?this.game.wait:1;this.game&&this.game.textEffect&&this.game.textEffect.to&&(this.game.textEffect.position=this.game.textEffect.to,delete this.game.textEffect.to),setTimeout((()=>{this.continue()}),e)},showTitle(e){this.title=e;const t=200;setTimeout((()=>{h().animate("divTitleParent",{height:0},{height:100},!1,t)}),10),setTimeout((()=>{h().animate("divTitleParent",{height:100},{height:0},!1,t)}),4.5*(t+10))},showCardMouseOver(e){this.aside&&this.showCard(e)},showCard(e){this.cardCenter=e?{id:e.id,position:e.position,to:{x:this.game.grid.center.x,y:this.game.grid.center.y,width:this.game.grid.center.width,height:this.game.grid.center.height,rotation:0}}:{id:this.cardCenter.id,position:this.cardCenter.position,to:{...this.cardCenter.position,height:0}};const t=[{id:"cardCenter",from:this.cardCenter.position,to:this.cardCenter.to,isIncrement:!1}];h().animateMultiple(t,_.getAnimDuration()),setTimeout((()=>{this.cardCenter.position=this.cardCenter.to,delete this.cardCenter.to}),510)},setDrag(){this.cards.forEach((e=>{const t="C"+e.index;this.addEvent(t,"dragstart",(t=>this.startDrag(t,e))),this.addEvent(t,"dragover",(t=>this.moveCard(t,e))),this.addEvent(t,"touchmove",(t=>this.moveCard(t,e))),this.addEvent(t,"touchstart",(t=>this.touchStart(t,e))),this.addEvent(t,"touchend",(t=>this.touchEnd(t,e)))}))},addEvent(e,t,a){const i=document.getElementById(e);i&&i.addEventListener(t,(e=>a(e)))},moveCard(e,t){if(!t&&t.isPlayer1!==this.game.isPlayer1||!t)return;let a=e.touches?e.touches[0].clientX:e.clientX,i=e.touches?e.touches[0].clientY:e.clientY;a-=t.position.width/2,i-=t.position.height/2;const r=e.target;r.style.left=`${a}px`,r.style.top=`${i}px`,t.positionDrag={x:a,y:i}},startDrag(e,t){!this.freeze&&t.isPlayer1===this.game.isPlayer1&&t&&(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage(new Image,0,0),e.dataTransfer.setData("card",t.index),t.moving=!0,t.positionOld=this.clone(t.position),e.target.style.zIndex="1000")},onDragOver(e){e.preventDefault()},onDrop(e){if(this.freeze)return;e.preventDefault();const t=e.clientX||e.pageX||(e.touches?e.touches[0].clientX:null),a=e.clientY||e.pageY||(e.touches?e.touches[0].clientY:null);e.target.style.zIndex="auto";const i=e.dataTransfer.getData("card"),r=this.getCard(i);if(!r)return;r.moving=!1;const n=this.cards.find((e=>e.index!==r.index&&this.isInside(t,a,e.position)&&!e.isPaired)),s=this.game.fields.find((e=>this.isInside(t,a,e)));this.playCard(r,n,s)},touchStart(e,t){!this.freeze&&t.isPlayer1===this.game.isPlayer1&&t&&(t.moving=!0,t.positionOld=this.clone(t.position),e.target.style.zIndex="1000")},touchEnd(e,t){if(this.freeze||t.isPlayer1!==this.game.isPlayer1||!t)return;t.moving=!1,e.target.style.zIndex="auto";const a=e.changedTouches[0],i=this.cards.find((e=>e.index!==t.index&&this.isInside(a.clientX,a.clientY,e.position)&&!e.isPaired)),r=this.game.fields.find((e=>this.isInside(a.clientX,a.clientY,e)));this.playCard(t,i,r)},isInside(e,t,a){const i=a.x,r=a.y,n=i+a.width,s=r+a.height;return e>=i&&e<=n&&t>=r&&t<=s},clone(e){return Object.assign({},e)},showText(e){alert(e)},getGridX(e){return this.game?.grid["x"+e]},getGridY(e){return this.game?.grid["y"+e]},getCard(e){return this.cards.find((t=>t.index==e))},getGridPlace(e,t){return{width:this.game?.grid.box.width+"px",height:this.game?.grid.box.height+"px",left:this.getGridX(e)+"px",top:this.getGridY(t)+"px"}},getFieldStyleObj(e){return this.getFieldStyle(e.x,e.y,e.width,e.height)},getFieldStyle(e,t,a,i){return{width:a+"px",height:i+"px",left:e+"px",top:t+"px"}}}},$=U,L=(0,H.Z)($,c,d,!1,null,"55c6073a",null),X=L.exports,Y={name:"pageGundamTcgFight",components:{menuBarGundam:n.Z,game:X},data:()=>({}),mounted(){},methods:{}},N=Y,j=(0,H.Z)(N,i,r,!1,null,null,null),W=j.exports},90490:function(){},61711:function(e,t,a){a(57658);class i{static animateElement(e,t,a,i){const r={element:e,from:t,to:a};this.animateElements([r],i)}static animateElements(e,t){const a=performance.now();function i(r){const n=r-a,s=Math.min(n/t,1),o=s<.5?2*s*s:1-Math.pow(-2*s+2,2)/2;e.forEach((e=>{const t=e.from.x+(e.to.x-e.from.x)*o,a=e.from.y+(e.to.y-e.from.y)*o,i=e.from.height+(e.to.height-e.from.height)*o,r=e.from.width+(e.to.width-e.from.width)*o,n=e.from.rotation+(e.to.rotation-e.from.rotation)*o;e.element.style.left=t+"px",e.element.style.top=a+"px",e.element.style.height=i+"px",e.element.style.width=r+"px",e.element.style.transform=`rotate(${n}deg)`})),s<1&&requestAnimationFrame(i)}requestAnimationFrame(i)}static easeInOut(e){return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2}static add(e,t){return{x:e.x+t.x,y:e.y+t.y,rotation:e.rotation+t.rotation}}static getRelativeTo0(e,t){return{x:t.x-e.x,y:t.y-e.y}}static pxStringToInt(e){return parseInt(e.replace("px",""))}static animate(e,t,i,r,n=a.g.delay){return this.animateMultiple([{id:e,from:t,to:i,isIncrement:r}],n)}static animateMultiple(e,t=-1){-1===t&&(t=a.g.delay);const i=[];e.forEach((e=>{const t=document.getElementById(e.id);if(!t)return void console.log("element can't be found : "+e.id);const a=e.from??{x:this.pxStringToInt(t.style.left),y:this.pxStringToInt(t.style.top),rotation:t.style.rotation,height:t.style.height,width:t.style.width};a.rotation=a.rotation??0,a.height=a.height??t.clientHeight;const r=e.isIncrement?this.add(a,e.to):e.to;i.push({element:t,from:a,to:r})})),this.animateElements(i,t)}}e.exports=i},85182:function(e,t,a){var i={"./EXBP-001.webp":69411,"./GD01-028.webp":21495,"./GD01-034.webp":63515,"./GD01-040.webp":66732,"./GD01-041.webp":70958,"./GD01-091.webp":81708,"./GD01-107.webp":66642,"./ST02-001.webp":58864,"./ST02-002.webp":23941,"./ST02-005.webp":55045,"./ST02-010.webp":99834,"./ST02-012.webp":57160,"./ST02-013.webp":55214,"./ST02-015.webp":34078};function r(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=n,e.exports=r,r.id=85182},97226:function(e,t,a){var i={"./Daggerheart/class/bard-banner.webp":85519,"./Daggerheart/class/druid-banner.webp":60992,"./Daggerheart/class/guardian-banner.webp":42548,"./Daggerheart/class/ranger-banner.webp":85811,"./Daggerheart/class/rogue-banner.webp":73300,"./Daggerheart/class/seraph-banner.webp":55354,"./Daggerheart/class/sorcerer-banner.webp":17294,"./Daggerheart/class/warrior-banner.webp":18201,"./Daggerheart/class/wizard-banner.webp":52234,"./Daggerheart/domain/banner-arcana.webp":63611,"./Daggerheart/domain/banner-blade.webp":62931,"./Daggerheart/domain/banner-bone.webp":33989,"./Daggerheart/domain/banner-codex.webp":79151,"./Daggerheart/domain/banner-grace.webp":64559,"./Daggerheart/domain/banner-midnight.webp":36595,"./Daggerheart/domain/banner-sage.webp":24162,"./Daggerheart/domain/banner-splendor.webp":52593,"./Daggerheart/domain/banner-valor.webp":89751,"./Daggerheart/domain/logo-arcana.webp":99903,"./Daggerheart/domain/logo-blade.webp":1753,"./Daggerheart/domain/logo-bone.webp":37935,"./Daggerheart/domain/logo-codex.webp":40820,"./Daggerheart/domain/logo-grace.webp":54010,"./Daggerheart/domain/logo-midnight.webp":7925,"./Daggerheart/domain/logo-sage.webp":99224,"./Daggerheart/domain/logo-splendor.webp":1373,"./Daggerheart/domain/logo-valor.webp":39249,"./Daggerheart/other/cost.webp":80987,"./Gundam/cards/EXBP-001.webp":69411,"./Gundam/cards/GD01-028.webp":21495,"./Gundam/cards/GD01-034.webp":63515,"./Gundam/cards/GD01-040.webp":66732,"./Gundam/cards/GD01-041.webp":70958,"./Gundam/cards/GD01-091.webp":81708,"./Gundam/cards/GD01-107.webp":66642,"./Gundam/cards/ST02-001.webp":58864,"./Gundam/cards/ST02-002.webp":23941,"./Gundam/cards/ST02-005.webp":55045,"./Gundam/cards/ST02-010.webp":99834,"./Gundam/cards/ST02-012.webp":57160,"./Gundam/cards/ST02-013.webp":55214,"./Gundam/cards/ST02-015.webp":34078,"./blue.webp":70148,"./dark.webp":87975,"./konamiCode.webp":95768};function r(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=n,e.exports=r,r.id=97226},60992:function(e,t,a){"use strict";e.exports=a.p+"img/druid-banner.2deb403f.webp"},52234:function(e,t,a){"use strict";e.exports=a.p+"img/wizard-banner.cd5737e8.webp"},62931:function(e,t,a){"use strict";e.exports=a.p+"img/banner-blade.30fc66e0.webp"},80987:function(e,t,a){"use strict";e.exports=a.p+"img/cost.8a36aa4e.webp"},68499:function(e,t,a){"use strict";e.exports=a.p+"img/GundamLogo2.e101246d.png"},69411:function(e,t,a){"use strict";e.exports=a.p+"img/EXBP-001.bf21c22f.webp"},21495:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-028.d05bd1e0.webp"},63515:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-034.f747b003.webp"},66732:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-040.acdadefd.webp"},70958:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-041.c76a26ff.webp"},81708:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-091.38c07c00.webp"},66642:function(e,t,a){"use strict";e.exports=a.p+"img/GD01-107.cbcb9846.webp"},58864:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-001.4b73f4fb.webp"},23941:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-002.b845951e.webp"},55045:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-005.8bffb70c.webp"},99834:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-010.33785975.webp"},57160:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-012.bb62e8de.webp"},55214:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-013.f56b594e.webp"},34078:function(e,t,a){"use strict";e.exports=a.p+"img/ST02-015.7e42f5aa.webp"},70898:function(e,t,a){"use strict";e.exports=a.p+"img/wingzero2.48fd7deb.gif"},70148:function(e,t,a){"use strict";e.exports=a.p+"img/blue.de89a950.webp"},87975:function(e,t,a){"use strict";e.exports=a.p+"img/dark.fff488e7.webp"},38525:function(e,t,a){"use strict";e.exports=a.p+"img/gradientBlack.a82f0a15.png"},95768:function(e,t,a){"use strict";e.exports=a.p+"img/konamiCode.ce17ba28.webp"},47327:function(e,t,a){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){if("object"!==i(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function n(e){var t=r(e,"string");return"symbol"===i(t)?t:String(t)}function s(e,t,a){return t=n(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{Z:function(){return s}})}}]);
//# sourceMappingURL=525.d419f4d7.js.map