{"version":3,"file":"js/67.3a51bad1.js","mappings":"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","sources":["webpack://front/./src/pages/pageFight.vue","webpack://front/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://front/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://front/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://front/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://front/./src/services/serviceFight.js","webpack://front/src/pages/pageFight.vue","webpack://front/./src/pages/pageFight.vue?8de7","webpack://front/./src/pages/pageFight.vue?e167"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('h1',[_vm._v(\"Les Combats\")]),_c('div',{staticClass:\"m5px\"},[_c('pre',[_vm._v(_vm._s(_vm.history))])]),_c('br'),_c('div',{staticStyle:{\"color\":\"white\"}},[_c('v-text-field',{staticClass:\"flex-grow m5px\",attrs:{\"hide-details\":\"\",\"label\":\"Écrire une commande et appuyer sur entrer\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.applyCommand.apply(null, arguments)}},model:{value:(_vm.command),callback:function ($$v) {_vm.command=$$v},expression:\"command\"}})],1),_c('h1',[_vm._v(\"Les Commandes\")]),_vm._m(0),_c('br')])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('pre',[_vm._v(\"    Une valeur peut être un nombre (exemple: 12) ou un texte sans espace (TresGros) ou une formule (1d20+5*8/3-4)\\n\\n    \"),_c('b',[_vm._v(\"Définir un personnage en lui donnant un nom et des valeurs.\")]),_vm._v(\"\\n    \"),_c('b',[_vm._v(\"set\")]),_vm._v(\" (nom du personnage) (propriété 1) (valeur 1) (propriété 2) (valeur 2) ...\\n    set aziel pv 20 shield 32 ca 19 ref 1d20+8 vig 1d20+8 vol 1d20+12 \\n    -- aziel have been updated\\n\\n    \"),_c('b',[_vm._v(\"Attaquer un personnage\")]),_vm._v(\"\\n    \"),_c('b',[_vm._v(\"attack\")]),_vm._v(\" (nom de la victime) (formule pour toucher) (propriété de défense de la victime) (formule de dégat) (propriété de vie) (nom de l'attaque)\\n    attack aziel 1d20+5 ca 1d8+3 pv Attaque de javelot \\n    -- Attack:1d20(15)+5=20 vs ca:19 ### the attack succeeded Damages:1d8(4)+3=7 aziel pv:20-7=13 ###\\n    \\n    \"),_c('b',[_vm._v(\"Attaquer un personnage avec un sort de défense\")]),_vm._v(\"\\n    \"),_c('b',[_vm._v(\"spell\")]),_vm._v(\" (nom de la victime) (DD pour toucher) (propriété de défense de la victime) (formule de dégat) (propriété de vie) (nom de l'attaque)\\n    spell aziel 18 ref 3d4 pv Arc électrique \\n    -- Attack:18 vs ref:1d20(16)+8=24 ### The attack partially fails.  Damages:3d4(6)/2=3 aziel pv:13-3=10 ###\\n    \\n    \"),_c('b',[_vm._v(\"Augmenter la valeur de propriétés\")]),_vm._v(\"\\n    \"),_c('b',[_vm._v(\"add\")]),_vm._v(\" (nom du personnage) (propriété 1) (valeur 1) (propriété 2) (valeur 2) ...\\n    add aziel pv 10 shield -2 \\n    -- aziel pv 10+10=20 shield 32-2=30\\n    \\n    \"),_c('b',[_vm._v(\"Montrer les valeurs d'un personnage\")]),_vm._v(\"\\n    \"),_c('b',[_vm._v(\"show\")]),_vm._v(\" (nom du personnage) (propriété 1) (propriété 2) ...\\n    show aziel pv shield \\n    -- aziel pv:20 shield:30\")])\n}]\n\nexport { render, staticRenderFns }","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","class ServiceFight {\r\n    \r\n    static creatures = [];\r\n\r\n    static handleAllCommand(message){\r\n        const msg = message.trim().toLowerCase();      \r\n        const result = [];\r\n        msg.split(',').forEach(x=> \r\n          this.handleCommand(result, x.trim()));\r\n      \r\n        return result.join('\\n');\r\n      }\r\n      \r\n      static handleCommand(result, command){\r\n        const instructions = command.split(' ');  \r\n        const name = instructions.shift();\r\n        let creature = this.getCreature(instructions);\r\n        if(!creature){\r\n          result.push( name + \" doesn't exist.\");\r\n        }\r\n        \r\n        if(command.startsWith('set'))\r\n          this.handleSet(result, creature, instructions);\r\n        \r\n        if(command.startsWith('show'))\r\n          this.handleShow(result, creature, instructions);\r\n        \r\n        if(command.startsWith('attack'))\r\n            this.handleAttack(result, creature, instructions, true);\r\n        \r\n        if(command.startsWith('spell'))\r\n            this.handleAttack(result, creature, instructions, false);\r\n        \r\n        if(command.startsWith('add'))\r\n            this.handleAdd(result, creature, instructions);\r\n      \r\n        if(result.length < 1)\r\n          result.push(\"No valid command.\");\r\n      }\r\n      \r\n      static getCreature(instructions){\r\n        const name = instructions.shift();\r\n        let creature = this.creatures.find(x=> x.name== name);\r\n        if(creature) return creature;\r\n      \r\n        creature = {name};\r\n        this.creatures.push(creature);\r\n        return creature;\r\n      }\r\n      \r\n      // set aziel pv 20 shield 32 ref 8 vig 8 vol 12\r\n      static handleSet(result, creature, instructions){\r\n        let i = 0;\r\n        while(instructions[i]){\r\n          const val = instructions[i+1];\r\n          const number = parseInt(val);\r\n          creature[instructions[i]] = isNaN(val) ? val : number;\r\n          i+=2;\r\n        }\r\n      \r\n        result.push(creature.name + ' have been updated');\r\n      }\r\n      \r\n      // show aziel pv shield\r\n      static handleShow(result, creature, instructions){\r\n        let i = 0;\r\n        let messages = [];\r\n        while(instructions[i]){\r\n          const val = creature[instructions[i]];\r\n          if(val)\r\n            messages.push(instructions[i] + \":\" + val);\r\n          i++;\r\n        }\r\n        result.push(creature.name + \" \" + messages.join(' '));\r\n      }\r\n      \r\n      // add snukbi pv 10 shield -2\r\n      static handleAdd(result, creature, instructions){\r\n        let i = 0;\r\n        let messages = [];\r\n        while(instructions[i]){\r\n          const attributeProperty = instructions[i];\r\n          let attributeValue = creature[attributeProperty];\r\n          if(isNaN(attributeValue))\r\n            messages.push(attributeProperty + \" x\");\r\n          else{\r\n            let rollInstruction = attributeValue + \"+\" + instructions[i+1];\r\n            rollInstruction = rollInstruction.replace(\"+-\", \"-\");\r\n            const updateValue = this.handleRoll(rollInstruction);\r\n            messages.push(attributeProperty + \" \" + updateValue.expression);\r\n            creature[attributeProperty] = updateValue.value;\r\n          }\r\n          i+=2;\r\n        }\r\n        result.push(creature.name + \" \" + messages.join(' '));\r\n      }\r\n      \r\n      // attack snukbi 1d20+5 ca 1d8+3 pv Attaque de javelot\r\n      // spell aziel 18 ref 3d4 pv Arc électrique\r\n      static handleAttack(result, creature, instructions, isNormalAttack){\r\n        const rollAtk = instructions.shift();\r\n        const targetProperty = instructions.shift();\r\n        const rollDam = instructions.shift();\r\n        const pvProperty = instructions.shift();\r\n        const label = instructions.join(' ');\r\n      \r\n        const targetValue = this.handleRoll(creature[targetProperty]);\r\n        const atk = this.handleRoll(rollAtk);\r\n      \r\n        if(!targetValue || isNaN(targetValue.value)){\r\n          result.push(\"-- \" + label + \" versus \"+ creature.name + \" -- Attack:\" + atk.expression + \" vs \" + targetProperty + \": ???\");\r\n          return;\r\n        }\r\n      \r\n        let message = \"-- \" + label + \" versus \"+ creature.name + \" -- Attack:\" + atk.expression + \" vs \" + targetProperty + \":\" + targetValue.expression;\r\n        \r\n        if(isNormalAttack) \r\n          message += this.ApplyDamageNormal(creature, atk, targetValue, rollDam, pvProperty);\r\n        else \r\n          message += this.ApplyDamageBasic(creature, atk, targetValue, rollDam, pvProperty);\r\n      \r\n        result.push(message);\r\n      }\r\n      \r\n      static ApplyDamageNormal(creature, atk, targetValue, rollDam, pvProperty){\r\n        if(atk.dice==1 || atk.value +10 <= targetValue.value)\r\n          return \" ### The attack critically fails ###\";  \r\n          \r\n        if(atk.value < targetValue.value)\r\n          return \" ### The attack fails ###\";  \r\n      \r\n        if(atk.dice >= 20 || atk.value - 10 >= targetValue.value){\r\n          rollDam+=\"*2\";\r\n          return \" ### the attack critically succeeded\" + this.ApplyDamage(creature, rollDam, pvProperty) + \" ###\";\r\n        }\r\n        \r\n        return \" ### the attack succeeded\" + this.ApplyDamage(creature, rollDam, pvProperty) + \" ###\";\r\n      }\r\n      \r\n      static ApplyDamageBasic(creature, atk, targetValue, rollDam, pvProperty){\r\n        if(targetValue.dice == 20 || targetValue.value - 10 >= atk.value)\r\n          return \" ### The attack critically fails ###\";\r\n      \r\n        if(targetValue.value >= atk.value){\r\n          rollDam+=\"/2\";\r\n          return \" ### The attack partially fails. \" + this.ApplyDamage(creature, rollDam, pvProperty) + \" ###\";\r\n        }\r\n      \r\n        if(targetValue.dice > 1 && targetValue.value + 10 > atk.value)\r\n          return \" ### the attack succeeded\" + this.ApplyDamage(creature, rollDam, pvProperty) + \" ###\";\r\n      \r\n        else {\r\n          rollDam+=\"*2\";\r\n          return \" ### the attack critically succeeded \" + this.ApplyDamage(creature, rollDam, pvProperty) + \" ###\";\r\n        }  \r\n      }\r\n      \r\n      static ApplyDamage(creature, rollDam, pvProperty){\r\n        const dam = this.handleRoll(rollDam);\r\n        let pvValue = this.handleRoll(creature[pvProperty]);\r\n        \r\n        let message = \" Damages:\" + dam.expression + \" \" + creature.name + \" \" + pvProperty + \":\" + pvValue.value + \"-\" + dam.value + \"=\";\r\n        pvValue.value-= dam.value;\r\n        creature[pvProperty]=pvValue.value;\r\n        message+= creature[pvProperty];\r\n        return message;\r\n      }\r\n      \r\n      static handleRoll(command){\r\n        if(!command) return;\r\n        const cmd = command.toString().replace(\"+\",\" + \").replace(\"-\",\" - \").replace(\"*\",\" * \").replace(\"/\",\" / \");\r\n        const isRoll = this.isIncludingOperator(cmd);\r\n        if(!isRoll)\r\n          return this.rollDice(cmd);\r\n        \r\n        let values = cmd.split(' ');\r\n        let result =this.rollDice(values.shift());\r\n          \r\n        while(values[0] && values[1]){\r\n          const operator = values.shift();\r\n          \r\n          let val2 = values.shift();\r\n          val2 = val2.includes(\"d\") ? this.rollDice(val2) : {expression:val2, value:parseInt(val2)};\r\n      \r\n          result.expression += operator + val2.expression;\r\n          if(operator == \"+\") result.value += val2.value;\r\n          if(operator == \"-\") result.value -= val2.value;\r\n          if(operator == \"*\") result.value *= val2.value;\r\n          if(operator == \"/\") result.value /= val2.value;\r\n        }\r\n        \r\n        result.expression += \"=\" + result.value;\r\n        return result;\r\n      }\r\n      \r\n      static isIncludingOperator(command){\r\n        return command.includes(\"+\") || command.includes(\"-\") || command.includes(\"*\") || command.includes(\"/\");\r\n      }\r\n      \r\n      static rollDice(command) {\r\n        if(!command.includes(\"d\"))\r\n          return {dice:10, expression:command, value:parseInt(command)};\r\n          \r\n        let values = command.split(\"d\");\r\n        const number=values.shift();\r\n        const faces=values.shift();\r\n        let result =0;\r\n        for(let i=0; i < number; i++)\r\n          result+= Math.floor(Math.random() * faces) + 1;\r\n      \r\n        return {dice:result, expression: command + \"(\" + result + \")\", value:result};\r\n      }\r\n}\r\n\r\n\r\nexport default ServiceFight;","<template>\r\n    <div>\r\n        <h1>Les Combats</h1>\r\n        <div class=\"m5px\">\r\n            <pre>{{ history }}</pre>\r\n        </div>\r\n        <br>\r\n       \r\n        <div style=\"color:white\">\r\n            <v-text-field class=\"flex-grow m5px\"\r\n                        hide-details\r\n                        v-model=\"command\"\r\n                        label=\"Écrire une commande et appuyer sur entrer\"\r\n                        @keydown.enter=\"applyCommand\">\r\n            </v-text-field>\r\n        </div>\r\n        <h1>Les Commandes</h1>\r\n        <pre>\r\n        Une valeur peut être un nombre (exemple: 12) ou un texte sans espace (TresGros) ou une formule (1d20+5*8/3-4)\r\n\r\n        <b>Définir un personnage en lui donnant un nom et des valeurs.</b>\r\n        <b>set</b> (nom du personnage) (propriété 1) (valeur 1) (propriété 2) (valeur 2) ...\r\n        set aziel pv 20 shield 32 ca 19 ref 1d20+8 vig 1d20+8 vol 1d20+12 \r\n        -- aziel have been updated\r\n\r\n        <b>Attaquer un personnage</b>\r\n        <b>attack</b> (nom de la victime) (formule pour toucher) (propriété de défense de la victime) (formule de dégat) (propriété de vie) (nom de l'attaque)\r\n        attack aziel 1d20+5 ca 1d8+3 pv Attaque de javelot \r\n        -- Attack:1d20(15)+5=20 vs ca:19 ### the attack succeeded Damages:1d8(4)+3=7 aziel pv:20-7=13 ###\r\n        \r\n        <b>Attaquer un personnage avec un sort de défense</b>\r\n        <b>spell</b> (nom de la victime) (DD pour toucher) (propriété de défense de la victime) (formule de dégat) (propriété de vie) (nom de l'attaque)\r\n        spell aziel 18 ref 3d4 pv Arc électrique \r\n        -- Attack:18 vs ref:1d20(16)+8=24 ### The attack partially fails.  Damages:3d4(6)/2=3 aziel pv:13-3=10 ###\r\n        \r\n        <b>Augmenter la valeur de propriétés</b>\r\n        <b>add</b> (nom du personnage) (propriété 1) (valeur 1) (propriété 2) (valeur 2) ...\r\n        add aziel pv 10 shield -2 \r\n        -- aziel pv 10+10=20 shield 32-2=30\r\n        \r\n        <b>Montrer les valeurs d'un personnage</b>\r\n        <b>show</b> (nom du personnage) (propriété 1) (propriété 2) ...\r\n        show aziel pv shield \r\n        -- aziel pv:20 shield:30</pre>\r\n        <br>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport ServiceFight from '../services/serviceFight'\r\nimport ServiceBack from '../services/serviceBack'\r\n\r\nexport default {\r\n  name: 'pageClub',\r\n  components: {},\r\n  data: () => ({\r\n    command : \"\",\r\n    history : \"\"\r\n  }),\r\n  mounted(){\r\n    ServiceBack.getAll('fight').then(result => {\r\n      this.history = result;\r\n    });\r\n  },\r\n  methods: {\r\n    applyCommand(){\r\n        const result = ServiceFight.handleAllCommand(this.command);\r\n        this.history += '\\n' + result;\r\n        ServiceBack.insert('fight', {message:result});\r\n    }\r\n  }\r\n};\r\n</script>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./pageFight.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./pageFight.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./pageFight.vue?vue&type=template&id=0fbcb376&\"\nimport script from \"./pageFight.vue?vue&type=script&lang=js&\"\nexport * from \"./pageFight.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["_c","_self","staticClass","_vm","_s","history","staticStyle","attrs","applyCommand","model","callback","command","expression","staticRenderFns","render","_typeof","obj","Symbol","iterator","constructor","prototype","_toPrimitive","input","hint","prim","toPrimitive","undefined","res","call","TypeError","String","Number","_toPropertyKey","arg","key","_defineProperty","value","toPropertyKey","Object","defineProperty","enumerable","configurable","writable","ServiceFight","static","message","msg","trim","toLowerCase","result","split","forEach","x","this","handleCommand","join","instructions","name","shift","creature","getCreature","push","startsWith","handleSet","handleShow","handleAttack","handleAdd","length","creatures","find","i","val","number","parseInt","isNaN","messages","attributeProperty","attributeValue","rollInstruction","replace","updateValue","handleRoll","isNormalAttack","rollAtk","targetProperty","rollDam","pvProperty","label","targetValue","atk","ApplyDamageNormal","ApplyDamageBasic","dice","ApplyDamage","dam","pvValue","cmd","toString","isRoll","isIncludingOperator","rollDice","values","operator","val2","includes","faces","Math","floor","random","components","data","mounted","ServiceBack","getAll","then","methods","handleAllCommand","insert","component"],"sourceRoot":""}